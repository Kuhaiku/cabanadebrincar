<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Depoimentos Fake</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body class="bg-slate-100 p-10">

    <div class="max-w-4xl mx-auto">
        <h1 class="text-3xl font-bold text-slate-800 mb-2">üå± Semeador de Depoimentos</h1>
        <p class="text-slate-500 mb-8">Anexe a foto correspondente a cada "persona" e clique em enviar para popular o banco.</p>

        <div id="lista-cards" class="grid gap-6">
            </div>
    </div>

    <script>
        // --- AQUI EST√ÉO OS TEXTOS QUE EU CRIEI PARA VOC√ä ---
        const personas = [
            {
                nome: "Juliana Paes",
                texto: "Amei cada detalhe! O kit soneca √© super confort√°vel e cheiroso. A festa neon ficou maravilhosa com as luzes das cabanas. Com certeza farei novamente ano que vem.",
                nota: 5,
                desc_foto: "üì∏ FOTO IDEAL: Uma foto geral das cabanas com luzes apagadas ou ambiente mais escuro destacando o NEON ou LUZINHAS."
            },
            {
                nome: "Pedro & Carla",
                texto: "Contratei para os meus filhos e superou as expectativas. As cabanas s√£o robustas e a decora√ß√£o ficou incr√≠vel. A equipe chegou no hor√°rio certinho.",
                nota: 5,
                desc_foto: "üì∏ FOTO IDEAL: Uma foto focada em MENINOS ou um tema mais neutro/aventura (ex: Harry Potter, Acampamento)."
            },
            {
                nome: "Patr√≠cia Amorim",
                texto: "Simplesmente encantada! As cabanas s√£o lindas, o tecido √© de qualidade. Minha filha amou a festa do pijama, foi inesquec√≠vel.",
                nota: 5,
                desc_foto: "üì∏ FOTO IDEAL: Uma foto bem feminina, rosa, princesas ou bem delicada."
            },
            {
                nome: "Fernanda Costa",
                texto: "Profissionalismo define. Desde o primeiro contato no WhatsApp at√© a desmontagem. Ficou tudo lindo e organizado. Minha sala virou um sonho!",
                nota: 5,
                desc_foto: "üì∏ FOTO IDEAL: Uma foto que mostre o ambiente inteiro (a sala transformada)."
            },
            {
                nome: "Clara Menezes",
                texto: "O caf√© da manh√£ nas bandejinhas foi o ponto alto! Elas acordaram e j√° foram comer na cabana. Experi√™ncia completa.",
                nota: 5,
                desc_foto: "üì∏ FOTO IDEAL: Uma foto focada nos detalhes: bandeja de caf√©, almofadas ou itens personalizados."
            }
        ];

        const container = document.getElementById('lista-cards');

        // Renderiza os Cards
        personas.forEach((p, index) => {
            const card = document.createElement('div');
            card.className = "bg-white p-6 rounded-xl shadow-sm border border-slate-200 flex flex-col md:flex-row gap-6 items-start";
            
            card.innerHTML = `
                <div class="flex-1">
                    <div class="flex justify-between mb-2">
                        <h3 class="font-bold text-lg text-slate-800">${p.nome}</h3>
                        <div class="text-yellow-400">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
                    </div>
                    <textarea id="texto-${index}" class="w-full border p-2 rounded text-slate-600 text-sm mb-2" rows="3">${p.texto}</textarea>
                    <div class="bg-blue-50 text-blue-700 text-xs p-3 rounded border border-blue-100 font-bold">
                        ${p.desc_foto}
                    </div>
                </div>

                <div class="w-full md:w-64 flex flex-col gap-3">
                    <input type="file" id="foto-${index}" class="block w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-violet-50 file:text-violet-700 hover:file:bg-violet-100"/>
                    
                    <button onclick="enviarDepoimento(${index}, '${p.nome}', ${p.nota})" id="btn-${index}" class="bg-slate-800 text-white font-bold py-2 px-4 rounded hover:bg-slate-700 transition-colors flex items-center justify-center gap-2">
                        <i data-lucide="upload-cloud" class="w-4 h-4"></i> Enviar Este
                    </button>
                </div>
            `;
            container.appendChild(card);
        });

        lucide.createIcons();
        const ADMIN_TOKEN = "Raposo88125442@@"; // Sua senha admin hardcoded para facilitar aqui

        async function enviarDepoimento(idx, nome, nota) {
            const btn = document.getElementById(`btn-${idx}`);
            const inputFoto = document.getElementById(`foto-${idx}`);
            const texto = document.getElementById(`texto-${idx}`).value;

            if(inputFoto.files.length === 0) {
                alert("‚ö†Ô∏è Por favor, selecione uma foto antes de enviar.");
                return;
            }

            btn.innerHTML = "Enviando...";
            btn.disabled = true;

            const formData = new FormData();
            formData.append("nome", nome);
            formData.append("texto", texto);
            formData.append("nota", nota);
            formData.append("foto", inputFoto.files[0]);

            try {
                const res = await fetch('/api/admin/seed-review', {
                    method: 'POST',
                    headers: { 'x-admin-password': ADMIN_TOKEN }, // Autentica√ß√£o
                    body: formData
                });

                const data = await res.json();
                
                if (data.success) {
                    btn.className = "bg-green-500 text-white font-bold py-2 px-4 rounded flex items-center justify-center gap-2";
                    btn.innerHTML = `<i data-lucide="check"></i> Sucesso!`;
                    btn.disabled = true; // Trava para n√£o reenviar
                    lucide.createIcons();
                } else {
                    alert("Erro: " + data.error);
                    btn.innerHTML = "Tentar Novamente";
                    btn.disabled = false;
                }
            } catch (error) {
                console.error(error);
                alert("Erro de conex√£o");
                btn.disabled = false;
            }
        }
    </script>
</body>
</html>